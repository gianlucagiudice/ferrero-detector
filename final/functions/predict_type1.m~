function outPrediction = predict_type1(cuts, classifier, debug)
    %% Valid masks
    valid1 = [2 2 2 2 2 2;
              1 1 1 1 1 1;
              1 1 1 1 1 1;
              3 3 3 3 3 3];

    valid2 = [3 3 3 3 3 3;
              1 1 1 1 1 1;
              1 1 1 1 1 1;
              2 2 2 2 2 2];
          
    %% Transpose cuts
    prediction = zeros(size(cuts))';
    
    %% Predict
    for i = 1 : numel(cuts)
        data = compute_qhist(cuts{i});
        prediction(i) = classifier.predict(data);
    end
    prediction = prediction';
    
    %% Errors
    
    diff1 = sum(prediction ~= valid1, 'all');
    diff2 = sum(prediction ~= valid2, 'all');

    outPrediction = prediction;
    if diff1 == 0 || diff2 == 0
        % Box is correct
        errors = zeros(4,6);
    else
        if diff1 < diff2
            errors = prediction ~= valid1;
        else
            errors = prediction ~= valid2;
        end
        outPrediction(errors) = 5;
    end
    
    
    if debug

        cmap = [232 185 35;
                229 228 225;
                52 34 17;
                179 33 52] / 255;
        l = [{'Rocher'}, {'Raffaello'}, {'Rondnoir'}, {'Wrong'}];
        
        figure(7);
        % Valid mask 1
        subplot(2,2,1);
        set(gca, 'ytick', [1:4]);
        set(gca, 'xtick', [1:6]);
        colormap(cmap(1: 3, :));
        N = 3;
        colorbar('Ticks',1:N, 'TickLabels', l(1:N));
        axis on, axis image;
        imagesc(valid1);title("Valid mask_1");

        % Valid mask 2
        subplot(2,2,2);
        set(gca, 'ytick', [1:4]);
        set(gca, 'xtick', [1:6]);
        colormap(cmap(1: 3, :));
        N = 3;
        colorbar('Ticks',1:N, 'TickLabels', l(1:N));
        axis on, axis image;
        imagesc(valid2);title("Valid mask_2");

        % Prediction
        subplot(2,2,3);
        set(gca, 'ytick', [1:4]);
        set(gca, 'xtick', [1:6]);
        N = length(unique(prediction));
        colormap(cmap(1: N, :));
        colorbar('Ticks',1:N, 'TickLabels', l(1:N));
        axis on, axis image;
        imagesc(prediction);title("Predictions");

        % OutPrediction
        subplot(2,2,4);
        set(gca, 'ytick', [1:4]);
        set(gca, 'xtick', [1:6]);
        N = length(unique(outPrediction));
        cm4 = colormap(cmap(1: N, :));
        cb4 = colorbar('Ticks',1:N, 'TickLabels', l(1:N));
        axis on, axis image;
        imagesc(outPrediction);title("Out predictions");

    end
end